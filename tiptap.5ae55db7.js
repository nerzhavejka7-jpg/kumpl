var ve=Object.defineProperty,Me=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Pt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var Ht=(e,t,n)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))Pt.call(t,n)&&Ht(e,n,t[n]);if(J)for(var n of J(t))$t.call(t,n)&&Ht(e,n,t[n]);return e},C=(e,t)=>Me(e,we(t));var It=(e,t)=>{var n={};for(var s in e)Pt.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&J)for(var s of J(e))t.indexOf(s)<0&&$t.call(e,s)&&(n[s]=e[s]);return n};import{a as $,P as R,N as V,S as z,A as Te,E as St,T as Se,F as Ce,G as Ae,I as P,J as xe,K as Ee,L as Le,M as Oe,O as He,Q as Pe,R as te,W as $e,X as Ie,Y as Re,Z as Ne,_ as Be,$ as De,a0 as _e,a1 as je,a2 as Fe,a3 as ze,a4 as We,a5 as Rt,a6 as Ke,a7 as tt,a8 as et,a9 as Ve,aa as qe,ab as Ue,ac as ee,ad as ft,ae as Ge,af as Je,ag as Xe,ah as Ye,ai as Qe,aj as Ze,ak as ne,al as D,V as rt,am as Nt,an as se,ao as tn,ap as en,aq as bt,ar as nt,as as nn,at as sn,au as rn,av as on,aw as an,ax as ln,ay as dn,az as Bt,aA as Dt,aB as _t,aC as cn,aD as un,aE as jt,aF as pn,aG as re,aH as hn,aI as fn,aJ as mn,aK as gn,aL as yn,aM as bn,aN as kn,aO as vn}from"./vendor.7bd6b934.js";function at(e){const{state:t,transaction:n}=e;let{selection:s}=n,{doc:r}=n,{storedMarks:o}=n;return C(y({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,o=n.storedMarks,n}})}class lt{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:r}=n,{tr:o}=s,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...u)=>{const c=l(...u)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(o),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a=[],l=!!t,d=t||o.tr,u=()=>(!l&&n&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(d),a.every(p=>p===!0)),c=C(y({},Object.fromEntries(Object.entries(s).map(([p,h])=>[p,(...g)=>{const b=this.buildProps(d,n),m=h(...g)(b);return a.push(m),c}]))),{run:u});return c}createCan(t){const{rawCommands:n,state:s}=this,r=!1,o=t||s.tr,i=this.buildProps(o,r),a=Object.fromEntries(Object.entries(n).map(([l,d])=>[l,(...u)=>d(...u)(C(y({},i),{dispatch:void 0}))]));return C(y({},a),{chain:()=>this.createChain(o,r)})}buildProps(t,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a={tr:t,editor:r,view:i,state:at({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([l,d])=>[l,(...u)=>d(...u)(a)]))}};return a}}class Mn{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const s=this.callbacks[t];return s&&s.forEach(r=>r.apply(this,n)),this}off(t,n){const s=this.callbacks[t];return s&&(n?this.callbacks[t]=s.filter(r=>r!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function k(e,t,n){return e.config[t]===void 0&&e.parent?k(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind(C(y({},n),{parent:e.parent?k(e.parent,t,n):null})):e.config[t]}function dt(e){const t=e.filter(r=>r.type==="extension"),n=e.filter(r=>r.type==="node"),s=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:s}}function oe(e){const t=[],{nodeExtensions:n,markExtensions:s}=dt(e),r=[...n,...s],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:r},l=k(i,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(c=>{Object.entries(u.attributes).forEach(([p,h])=>{t.push({type:c,name:p,attribute:y(y({},o),h)})})})})}),r.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=k(i,"addAttributes",a);if(!l)return;const d=l();Object.entries(d).forEach(([u,c])=>{const p=y(y({},o),c);typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:i.name,name:u,attribute:p})})}),t}function O(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function w(...e){return e.filter(t=>!!t).reduce((t,n)=>{const s=y({},t);return Object.entries(n).forEach(([r,o])=>{if(!s[r]){s[r]=o;return}if(r==="class"){const a=o?o.split(" "):[],l=s[r]?s[r].split(" "):[],d=a.filter(u=>!l.includes(u));s[r]=[...l,...d].join(" ")}else r==="style"?s[r]=[s[r],o].join("; "):s[r]=o}),s},{})}function kt(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,s)=>w(n,s),{})}function ie(e){return typeof e=="function"}function M(e,t=void 0,...n){return ie(e)?t?e.bind(t)(...n):e(...n):e}function wn(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Tn(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Ft(e,t){return"style"in e?e:C(y({},e),{getAttrs:n=>{const s=e.getAttrs?e.getAttrs(n):e.attrs;if(s===!1)return!1;const r=t.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):Tn(n.getAttribute(i.name));return a==null?o:C(y({},o),{[i.name]:a})},{});return y(y({},s),r)}})}function zt(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&wn(n)?!1:n!=null))}function Sn(e,t){var n;const s=oe(e),{nodeExtensions:r,markExtensions:o}=dt(e),i=(n=r.find(d=>k(d,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(r.map(d=>{const u=s.filter(m=>m.type===d.name),c={name:d.name,options:d.options,storage:d.storage,editor:t},p=e.reduce((m,v)=>{const T=k(v,"extendNodeSchema",c);return y(y({},m),T?T(d):{})},{}),h=zt(C(y({},p),{content:M(k(d,"content",c)),marks:M(k(d,"marks",c)),group:M(k(d,"group",c)),inline:M(k(d,"inline",c)),atom:M(k(d,"atom",c)),selectable:M(k(d,"selectable",c)),draggable:M(k(d,"draggable",c)),code:M(k(d,"code",c)),whitespace:M(k(d,"whitespace",c)),defining:M(k(d,"defining",c)),isolating:M(k(d,"isolating",c)),attrs:Object.fromEntries(u.map(m=>{var v;return[m.name,{default:(v=m==null?void 0:m.attribute)===null||v===void 0?void 0:v.default}]}))})),f=M(k(d,"parseHTML",c));f&&(h.parseDOM=f.map(m=>Ft(m,u)));const g=k(d,"renderHTML",c);g&&(h.toDOM=m=>g({node:m,HTMLAttributes:kt(m,u)}));const b=k(d,"renderText",c);return b&&(h.toText=b),[d.name,h]})),l=Object.fromEntries(o.map(d=>{const u=s.filter(b=>b.type===d.name),c={name:d.name,options:d.options,storage:d.storage,editor:t},p=e.reduce((b,m)=>{const v=k(m,"extendMarkSchema",c);return y(y({},b),v?v(d):{})},{}),h=zt(C(y({},p),{inclusive:M(k(d,"inclusive",c)),excludes:M(k(d,"excludes",c)),group:M(k(d,"group",c)),spanning:M(k(d,"spanning",c)),code:M(k(d,"code",c)),attrs:Object.fromEntries(u.map(b=>{var m;return[b.name,{default:(m=b==null?void 0:b.attribute)===null||m===void 0?void 0:m.default}]}))})),f=M(k(d,"parseHTML",c));f&&(h.parseDOM=f.map(b=>Ft(b,u)));const g=k(d,"renderHTML",c);return g&&(h.toDOM=b=>g({mark:b,HTMLAttributes:kt(b,u)})),[d.name,h]}));return new ee({topNode:i,nodes:a,marks:l})}function mt(e,t){return t.nodes[e]||t.marks[e]||null}function Wt(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const Cn=(e,t=500)=>{let n="";const s=e.parentOffset;return e.parent.nodesBetween(Math.max(0,s-t),s,(r,o,i,a)=>{var l,d;const u=((d=(l=r.type.spec).toText)===null||d===void 0?void 0:d.call(l,{node:r,pos:o,parent:i,index:a}))||r.textContent||"%leaf%";n+=r.isAtom&&!r.isText?u:u.slice(0,Math.max(0,s-o))}),n};function Ct(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class ct{constructor(t){this.find=t.find,this.handler=t.handler}}const An=(e,t)=>{if(Ct(t))return t.exec(e);const n=t(e);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=e,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function X(e){var t;const{editor:n,from:s,to:r,text:o,rules:i,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const d=l.state.doc.resolve(s);if(d.parent.type.spec.code||!((t=d.nodeBefore||d.nodeAfter)===null||t===void 0)&&t.marks.find(p=>p.type.spec.code))return!1;let u=!1;const c=Cn(d)+o;return i.forEach(p=>{if(u)return;const h=An(c,p.find);if(!h)return;const f=l.state.tr,g=at({state:l.state,transaction:f}),b={from:s-(h[0].length-o.length),to:r},{commands:m,chain:v,can:T}=new lt({editor:n,state:g});p.handler({state:g,range:b,match:h,commands:m,chain:v,can:T})===null||!f.steps.length||(f.setMeta(a,{transform:f,from:s,to:r,text:o}),l.dispatch(f),u=!0)}),u}function xn(e){const{editor:t,rules:n}=e,s=new $({state:{init(){return null},apply(r,o){const i=r.getMeta(s);if(i)return i;const a=r.getMeta("applyInputRules");return!!a&&setTimeout(()=>{const{from:d,text:u}=a,c=d+u.length;X({editor:t,from:d,to:c,text:u,rules:n,plugin:s})}),r.selectionSet||r.docChanged?null:o}},props:{handleTextInput(r,o,i,a){return X({editor:t,from:o,to:i,text:a,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:o}=r.state.selection;o&&X({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,o){if(o.key!=="Enter")return!1;const{$cursor:i}=r.state.selection;return i?X({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function En(e){return typeof e=="number"}class Ln{constructor(t){this.find=t.find,this.handler=t.handler}}const On=(e,t,n)=>{if(Ct(t))return[...e.matchAll(t)];const s=t(e,n);return s?s.map(r=>{const o=[r.text];return o.index=r.index,o.input=e,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function Hn(e){const{editor:t,state:n,from:s,to:r,rule:o,pasteEvent:i,dropEvent:a}=e,{commands:l,chain:d,can:u}=new lt({editor:t,state:n}),c=[];return n.doc.nodesBetween(s,r,(h,f)=>{if(!h.isTextblock||h.type.spec.code)return;const g=Math.max(s,f),b=Math.min(r,f+h.content.size),m=h.textBetween(g-f,b-f,void 0,"￼");On(m,o.find,i).forEach(T=>{if(T.index===void 0)return;const x=g+T.index+1,E=x+T[0].length,S={from:n.tr.mapping.map(x),to:n.tr.mapping.map(E)},I=o.handler({state:n,range:S,match:T,commands:l,chain:d,can:u,pasteEvent:i,dropEvent:a});c.push(I)})}),c.every(h=>h!==null)}const Pn=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n};function $n(e){const{editor:t,rules:n}=e;let s=null,r=!1,o=!1,i=typeof ClipboardEvent!="undefined"?new ClipboardEvent("paste"):null,a=typeof DragEvent!="undefined"?new DragEvent("drop"):null;const l=({state:u,from:c,to:p,rule:h,pasteEvt:f})=>{const g=u.tr,b=at({state:u,transaction:g});if(!(!Hn({editor:t,state:b,from:Math.max(c-1,0),to:p.b-1,rule:h,pasteEvent:f,dropEvent:a})||!g.steps.length))return a=typeof DragEvent!="undefined"?new DragEvent("drop"):null,i=typeof ClipboardEvent!="undefined"?new ClipboardEvent("paste"):null,g};return n.map(u=>new $({view(c){const p=h=>{var f;s=!((f=c.dom.parentElement)===null||f===void 0)&&f.contains(h.target)?c.dom.parentElement:null};return window.addEventListener("dragstart",p),{destroy(){window.removeEventListener("dragstart",p)}}},props:{handleDOMEvents:{drop:(c,p)=>(o=s===c.dom.parentElement,a=p,!1),paste:(c,p)=>{var h;const f=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return i=p,r=!!(f!=null&&f.includes("data-pm-slice")),!1}}},appendTransaction:(c,p,h)=>{const f=c[0],g=f.getMeta("uiEvent")==="paste"&&!r,b=f.getMeta("uiEvent")==="drop"&&!o,m=f.getMeta("applyPasteRules"),v=!!m;if(!g&&!b&&!v)return;if(v){const{from:E,text:S}=m,I=E+S.length,N=Pn(S);return l({rule:u,state:h,from:E,to:{b:I},pasteEvt:N})}const T=p.doc.content.findDiffStart(h.doc.content),x=p.doc.content.findDiffEnd(h.doc.content);if(!(!En(T)||!x||T===x.b))return l({rule:u,state:h,from:T,to:x,pasteEvt:i})}}))}function In(e){const t=e.filter((n,s)=>e.indexOf(n)!==s);return Array.from(new Set(t))}class K{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=K.resolve(t),this.schema=Sn(this.extensions,n),this.setupExtensions()}static resolve(t){const n=K.sort(K.flatten(t)),s=In(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=k(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(t){return t.sort((s,r)=>{const o=k(s,"priority")||100,i=k(r,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:mt(n.name,this.schema)},r=k(n,"addCommands",s);return r?y(y({},t),r()):t},{})}get plugins(){const{editor:t}=this,n=K.sort([...this.extensions].reverse()),s=[],r=[],o=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:t,type:mt(i.name,this.schema)},l=[],d=k(i,"addKeyboardShortcuts",a);let u={};if(i.type==="mark"&&k(i,"exitable",a)&&(u.ArrowRight=()=>H.handleExit({editor:t,mark:i})),d){const g=Object.fromEntries(Object.entries(d()).map(([b,m])=>[b,()=>m({editor:t})]));u=y(y({},u),g)}const c=Qe(u);l.push(c);const p=k(i,"addInputRules",a);Wt(i,t.options.enableInputRules)&&p&&s.push(...p());const h=k(i,"addPasteRules",a);Wt(i,t.options.enablePasteRules)&&h&&r.push(...h());const f=k(i,"addProseMirrorPlugins",a);if(f){const g=f();l.push(...g)}return l}).flat();return[xn({editor:t,rules:s}),...$n({editor:t,rules:r}),...o]}get attributes(){return oe(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=dt(this.extensions);return Object.fromEntries(n.filter(s=>!!k(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),o={name:s.name,options:s.options,storage:s.storage,editor:t,type:O(s.name,this.schema)},i=k(s,"addNodeView",o);if(!i)return[];const a=(l,d,u,c)=>{const p=kt(l,r);return i()({editor:t,node:l,getPos:u,decorations:c,HTMLAttributes:p,extension:s})};return[s.name,a]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const s={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:mt(t.name,this.schema)};t.type==="mark"&&(!((n=M(k(t,"keepOnSplit",s)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(t.name);const r=k(t,"onBeforeCreate",s),o=k(t,"onCreate",s),i=k(t,"onUpdate",s),a=k(t,"onSelectionUpdate",s),l=k(t,"onTransaction",s),d=k(t,"onFocus",s),u=k(t,"onBlur",s),c=k(t,"onDestroy",s);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),d&&this.editor.on("focus",d),u&&this.editor.on("blur",u),c&&this.editor.on("destroy",c)})}}function Rn(e){return Object.prototype.toString.call(e).slice(8,-1)}function Y(e){return Rn(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function ut(e,t){const n=y({},e);return Y(e)&&Y(t)&&Object.keys(t).forEach(s=>{Y(t[s])&&Y(e[s])?n[s]=ut(e[s],t[s]):n[s]=t[s]}),n}class L{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=y(y({},this.config),t),this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(k(this,"addOptions",{name:this.name}))),this.storage=M(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new L(t)}configure(t={}){const n=this.extend(C(y({},this.config),{addOptions:()=>ut(this.options,t)}));return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new L(y(y({},this.config),t));return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(k(n,"addOptions",{name:n.name})),n.storage=M(k(n,"addStorage",{name:n.name,options:n.options})),n}}function ae(e,t,n){const{from:s,to:r}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return e.nodesBetween(s,r,(l,d,u,c)=>{var p;l.isBlock&&d>s&&(a+=o);const h=i==null?void 0:i[l.type.name];if(h)return u&&(a+=h({node:l,pos:d,parent:u,index:c,range:t})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(s,d)-d,r-d))}),a}function le(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const Nn=L.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new $({key:new R("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:s,selection:r}=t,{ranges:o}=r,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=le(n);return ae(s,{from:i,to:a},C(y({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),Bn=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Dn=(e=!1)=>({commands:t})=>t.setContent("",e),_n=()=>({state:e,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:r}=s;return n&&r.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:d,mapping:u}=t,c=d.resolve(u.map(l)),p=d.resolve(u.map(l+a.nodeSize)),h=c.blockRange(p);if(!h)return;const f=Ce(h);if(a.type.isTextblock){const{defaultType:g}=c.parent.contentMatchAt(c.index());t.setNodeMarkup(h.start,g)}(f||f===0)&&t.lift(h,f)})}),!0},jn=e=>t=>e(t),Fn=()=>({state:e,dispatch:t})=>Ae(e,t),zn=(e,t)=>({editor:n,tr:s})=>{const{state:r}=n,o=r.doc.slice(e.from,e.to);s.deleteRange(e.from,e.to);const i=s.mapping.map(t);return s.insert(i,o.content),s.setSelection(new P(s.doc.resolve(i-1))),!0},Wn=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,s=n.$anchor.node();if(s.content.size>0)return!1;const r=e.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===s.type){if(t){const a=r.before(o),l=r.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1},Kn=e=>({tr:t,state:n,dispatch:s})=>{const r=O(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===r){if(s){const l=o.before(i),d=o.after(i);t.delete(l,d).scrollIntoView()}return!0}return!1},Vn=e=>({tr:t,dispatch:n})=>{const{from:s,to:r}=e;return n&&t.delete(s,r),!0},qn=()=>({state:e,dispatch:t})=>xe(e,t),Un=()=>({commands:e})=>e.keyboardShortcut("Enter"),Gn=()=>({state:e,dispatch:t})=>Ee(e,t);function ot(e,t,n={strict:!0}){const s=Object.keys(t);return s.length?s.every(r=>n.strict?t[r]===e[r]:Ct(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function vt(e,t,n={}){return e.find(s=>s.type===t&&ot(s.attrs,n))}function Jn(e,t,n={}){return!!vt(e,t,n)}function At(e,t,n={}){if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if(e.parentOffset===s.offset&&s.offset!==0&&(s=e.parent.childBefore(e.parentOffset)),!s.node)return;const r=vt([...s.node.marks],t,n);if(!r)return;let o=s.index,i=e.start()+s.offset,a=o+1,l=i+s.node.nodeSize;for(vt([...s.node.marks],t,n);o>0&&r.isInSet(e.parent.child(o-1).marks);)o-=1,i-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&Jn([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:i,to:l}}function j(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const Xn=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const o=j(e,s.schema),{doc:i,selection:a}=n,{$from:l,from:d,to:u}=a;if(r){const c=At(l,o,t);if(c&&c.from<=d&&c.to>=u){const p=P.create(i,c.from,c.to);n.setSelection(p)}}return!0},Yn=e=>t=>{const n=typeof e=="function"?e(t):e;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1};function xt(e){return e instanceof P}function B(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function de(e,t=null){if(!t)return null;const n=z.atStart(e),s=z.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return s;const r=n.from,o=s.to;return t==="all"?P.create(e,B(0,r,o),B(e.content.size,r,o)):P.create(e,B(t,r,o),B(t,r,o))}function pt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Qn=(e=null,t={})=>({editor:n,view:s,tr:r,dispatch:o})=>{t=y({scrollIntoView:!0},t);const i=()=>{pt()&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!xt(n.state.selection))return i(),!0;const a=de(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},Zn=(e,t)=>n=>e.every((s,r)=>t(s,C(y({},n),{index:r}))),ts=(e,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),ce=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const s=t[n];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?e.removeChild(s):s.nodeType===1&&ce(s)}return e};function Q(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return ce(n)}function it(e,t,n){n=y({slice:!0,parseOptions:{}},n);const s=typeof e=="object"&&e!==null,r=typeof e=="string";if(s)try{return Array.isArray(e)&&e.length>0?et.fromArray(e.map(i=>t.nodeFromJSON(i))):t.nodeFromJSON(e)}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),it("",t,n)}if(r){if(n.errorOnInvalidContent){let i=!1,a="";const l=new ee({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(i=!0,a=typeof d=="string"?d:d.outerHTML,null)}]}})});if(n.slice?ft.fromSchema(l).parseSlice(Q(e),n.parseOptions):ft.fromSchema(l).parse(Q(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=ft.fromSchema(t);return n.slice?o.parseSlice(Q(e),n.parseOptions).content:o.parse(Q(e),n.parseOptions)}return it("",t,n)}function es(e,t,n){const s=e.steps.length-1;if(s<t)return;const r=e.steps[s];if(!(r instanceof Ge||r instanceof Je))return;const o=e.mapping.maps[s];let i=0;o.forEach((a,l,d,u)=>{i===0&&(i=u)}),e.setSelection(z.near(e.doc.resolve(i),n))}const ns=e=>!("type"in e),ss=(e,t,n)=>({tr:s,dispatch:r,editor:o})=>{var i;if(r){n=y({parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},n);let a;try{a=it(t,o.schema,{parseOptions:y({preserveWhitespace:"full"},n.parseOptions),errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(f){return o.emit("contentError",{editor:o,error:f,disableCollaboration:()=>{console.error("[tiptap error]: Unable to disable collaboration at this point in time")}}),!1}let{from:l,to:d}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},u=!0,c=!0;if((ns(a)?a:[a]).forEach(f=>{f.check(),u=u?f.isText&&f.marks.length===0:!1,c=c?f.isBlock:!1}),l===d&&c){const{parent:f}=s.doc.resolve(l);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(l-=1,d+=1)}let h;u?(Array.isArray(t)?h=t.map(f=>f.text||"").join(""):typeof t=="object"&&t&&t.text?h=t.text:h=t,s.insertText(h,l,d)):(h=a,s.replaceWith(l,d,h)),n.updateSelection&&es(s,s.steps.length-1,-1),n.applyInputRules&&s.setMeta("applyInputRules",{from:l,text:h}),n.applyPasteRules&&s.setMeta("applyPasteRules",{from:l,text:h})}return!0},rs=()=>({state:e,dispatch:t})=>Le(e,t),os=()=>({state:e,dispatch:t})=>Oe(e,t),is=()=>({state:e,dispatch:t})=>He(e,t),as=()=>({state:e,dispatch:t})=>Pe(e,t),ls=()=>({state:e,dispatch:t,tr:n})=>{try{const s=te(e.doc,e.selection.$from.pos,-1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch(s){return!1}},ds=()=>({state:e,dispatch:t,tr:n})=>{try{const s=te(e.doc,e.selection.$from.pos,1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch(s){return!1}},cs=()=>({state:e,dispatch:t})=>$e(e,t),us=()=>({state:e,dispatch:t})=>Ie(e,t);function ue(){return typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1}function ps(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let s,r,o,i;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))pt()||ue()?i=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const hs=e=>({editor:t,view:n,tr:s,dispatch:r})=>{const o=ps(e).split(/-(?!$)/),i=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",d=>d(n,a))});return l==null||l.steps.forEach(d=>{const u=d.map(s.mapping);u&&r&&s.maybeStep(u)}),!0};function U(e,t,n={}){const{from:s,to:r,empty:o}=e.selection,i=t?O(t,e.schema):null,a=[];e.doc.nodesBetween(s,r,(c,p)=>{if(c.isText)return;const h=Math.max(s,p),f=Math.min(r,p+c.nodeSize);a.push({node:c,from:h,to:f})});const l=r-s,d=a.filter(c=>i?i.name===c.node.type.name:!0).filter(c=>ot(c.node.attrs,n,{strict:!1}));return o?!!d.length:d.reduce((c,p)=>c+p.to-p.from,0)>=l}const fs=(e,t={})=>({state:n,dispatch:s})=>{const r=O(e,n.schema);return U(n,r,t)?Re(n,s):!1},ms=()=>({state:e,dispatch:t})=>Ne(e,t),gs=e=>({state:t,dispatch:n})=>{const s=O(e,t.schema);return Be(s)(t,n)},ys=()=>({state:e,dispatch:t})=>De(e,t);function ht(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Kt(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((s,r)=>(n.includes(r)||(s[r]=e[r]),s),{})}const bs=(e,t)=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=ht(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(o=O(e,s.schema)),a==="mark"&&(i=j(e,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(d,u)=>{o&&o===d.type&&n.setNodeMarkup(u,void 0,Kt(d.attrs,t)),i&&d.marks.length&&d.marks.forEach(c=>{i===c.type&&n.addMark(u,u+d.nodeSize,i.create(Kt(c.attrs,t)))})})}),!0):!1},ks=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),vs=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),Ms=()=>({state:e,dispatch:t})=>_e(e,t),ws=()=>({state:e,dispatch:t})=>je(e,t),Ts=()=>({state:e,dispatch:t})=>Fe(e,t),Ss=()=>({state:e,dispatch:t})=>ze(e,t),Cs=()=>({state:e,dispatch:t})=>We(e,t);function Mt(e,t,n={},s={}){return it(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:s.errorOnInvalidContent})}const As=(e,t=!1,n={},s={})=>({editor:r,tr:o,dispatch:i,commands:a})=>{var l,d;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const c=Mt(e,r.schema,n,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return i&&o.replaceWith(0,u.content.size,c).setMeta("preventUpdate",!t),!0}return i&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:u.content.size},e,{parseOptions:n,errorOnInvalidContent:(d=s.errorOnInvalidContent)!==null&&d!==void 0?d:r.options.enableContentCheck})};function G(e,t){const n=j(t,e.schema),{from:s,to:r,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(s,r,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?y({},a.attrs):{}}function xs(e,t){const n=new Se(e);return t.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function Es(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Ls(e,t,n){const s=[];return e.nodesBetween(t.from,t.to,(r,o)=>{n(r)&&s.push({node:r,pos:o})}),s}function pe(e,t){for(let n=e.depth;n>0;n-=1){const s=e.node(n);if(t(s))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:s}}}function Et(e){return t=>pe(t.$from,e)}function Os(e,t){const n=Ze.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Hs(e,t){const n={from:0,to:e.content.size};return ae(e,n,t)}function Ps(e,t){const n=O(t,e.schema),{from:s,to:r}=e.selection,o=[];e.doc.nodesBetween(s,r,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?y({},i.attrs):{}}function he(e,t){const n=ht(typeof t=="string"?t:t.name,e.schema);return n==="node"?Ps(e,t):n==="mark"?G(e,t):{}}function $s(e,t=JSON.stringify){const n={};return e.filter(s=>{const r=t(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function Is(e){const t=$s(e);return t.length===1?t:t.filter((n,s)=>!t.filter((o,i)=>i!==s).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function Rs(e){const{mapping:t,steps:n}=e,s=[];return t.maps.forEach((r,o)=>{const i=[];if(r.ranges.length)r.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const d=t.slice(o).map(a,-1),u=t.slice(o).map(l),c=t.invert().map(d,-1),p=t.invert().map(u);s.push({oldRange:{from:c,to:p},newRange:{from:d,to:u}})})}),Is(s)}function Lt(e,t,n){const s=[];return e===t?n.resolve(e).marks().forEach(r=>{const o=n.resolve(e),i=At(o,r.type);i&&s.push(y({mark:r},i))}):n.nodesBetween(e,t,(r,o)=>{!r||(r==null?void 0:r.nodeSize)===void 0||s.push(...r.marks.map(i=>({from:o,to:o+r.nodeSize,mark:i})))}),s}function st(e,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=e.find(o=>o.type===t&&o.name===s);return r?r.attribute.keepOnSplit:!1}))}function wt(e,t,n={}){const{empty:s,ranges:r}=e.selection,o=t?j(t,e.schema):null;if(s)return!!(e.storedMarks||e.selection.$from.marks()).filter(c=>o?o.name===c.type.name:!0).find(c=>ot(c.attrs,n,{strict:!1}));let i=0;const a=[];if(r.forEach(({$from:c,$to:p})=>{const h=c.pos,f=p.pos;e.doc.nodesBetween(h,f,(g,b)=>{if(!g.isText&&!g.marks.length)return;const m=Math.max(h,b),v=Math.min(f,b+g.nodeSize),T=v-m;i+=T,a.push(...g.marks.map(x=>({mark:x,from:m,to:v})))})}),i===0)return!1;const l=a.filter(c=>o?o.name===c.mark.type.name:!0).filter(c=>ot(c.mark.attrs,n,{strict:!1})).reduce((c,p)=>c+p.to-p.from,0),d=a.filter(c=>o?c.mark.type!==o&&c.mark.type.excludes(o):!0).reduce((c,p)=>c+p.to-p.from,0);return(l>0?l+d:l)>=i}function Ns(e,t,n={}){if(!t)return U(e,null,n)||wt(e,null,n);const s=ht(t,e.schema);return s==="node"?U(e,t,n):s==="mark"?wt(e,t,n):!1}function Vt(e,t){const{nodeExtensions:n}=dt(t),s=n.find(i=>i.name===e);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},o=M(k(s,"group",r));return typeof o!="string"?!1:o.split(" ").includes("list")}function Ot(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var s;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((s=e.text)!==null&&s!==void 0?s:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let r=!0;return e.content.forEach(o=>{r!==!1&&(Ot(o,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function fe(e){return e instanceof V}function me(e,t,n){const r=e.state.doc.content.size,o=B(t,0,r),i=B(n,0,r),a=e.coordsAtPos(o),l=e.coordsAtPos(i,-1),d=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),c=Math.min(a.left,l.left),p=Math.max(a.right,l.right),h=p-c,f=u-d,m={top:d,bottom:u,left:c,right:p,width:h,height:f,x:c,y:d};return C(y({},m),{toJSON:()=>m})}function Bs(e,t,n){var s;const{selection:r}=t;let o=null;if(xt(r)&&(o=r.$cursor),o){const a=(s=e.storedMarks)!==null&&s!==void 0?s:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=r;return i.some(({$from:a,$to:l})=>{let d=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(u,c,p)=>{if(d)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),f=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));d=h&&f}return!d}),d})}const Ds=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=j(e,s.schema);if(r)if(i){const d=G(s,l);n.addStoredMark(l.create(y(y({},d),t)))}else a.forEach(d=>{const u=d.$from.pos,c=d.$to.pos;s.doc.nodesBetween(u,c,(p,h)=>{const f=Math.max(h,u),g=Math.min(h+p.nodeSize,c);p.marks.find(m=>m.type===l)?p.marks.forEach(m=>{l===m.type&&n.addMark(f,g,l.create(y(y({},m.attrs),t)))}):n.addMark(f,g,l.create(t))})});return Bs(s,n,l)},_s=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),js=(e,t={})=>({state:n,dispatch:s,chain:r})=>{const o=O(e,n.schema);return o.isTextblock?r().command(({commands:i})=>Rt(o,t)(n)?!0:i.clearNodes()).command(({state:i})=>Rt(o,t)(i,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Fs=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,r=B(e,0,s.content.size),o=V.create(s,r);t.setSelection(o)}return!0},zs=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:r,to:o}=typeof e=="number"?{from:e,to:e}:e,i=P.atStart(s).from,a=P.atEnd(s).to,l=B(r,i,a),d=B(o,i,a),u=P.create(s,l,d);t.setSelection(u)}return!0},Ws=e=>({state:t,dispatch:n})=>{const s=O(e,t.schema);return Ke(s)(t,n)};function qt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const s=n.filter(r=>t==null?void 0:t.includes(r.type.name));e.tr.ensureMarks(s)}}const Ks=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:s,editor:r})=>{const{selection:o,doc:i}=t,{$from:a,$to:l}=o,d=r.extensionManager.attributes,u=st(d,a.node().type.name,a.node().attrs);if(o instanceof V&&o.node.isBlock)return!a.parentOffset||!tt(i,a.pos)?!1:(s&&(e&&qt(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const c=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:Es(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=c&&p?[{type:p,attrs:u}]:void 0,f=tt(t.doc,t.mapping.map(a.pos),1,h);if(!h&&!f&&tt(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(f=!0,h=p?[{type:p,attrs:u}]:void 0),s){if(f&&(o instanceof P&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),p&&!c&&!a.parentOffset&&a.parent.type!==p)){const g=t.mapping.map(a.before()),b=t.doc.resolve(g);a.node(-1).canReplaceWith(b.index(),b.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&qt(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return f},Vs=(e,t={})=>({tr:n,state:s,dispatch:r,editor:o})=>{var i;const a=O(e,s.schema),{$from:l,$to:d}=s.selection,u=s.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(d))return!1;const c=l.node(-1);if(c.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let m=et.empty;const v=l.index(-1)?1:l.index(-2)?2:3;for(let N=l.depth-v;N>=l.depth-3;N-=1)m=et.from(l.node(N).copy(m));const T=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,x=y(y({},st(p,l.node().type.name,l.node().attrs)),t),E=((i=a.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(x))||void 0;m=m.append(et.from(a.createAndFill(null,E)||void 0));const S=l.before(l.depth-(v-1));n.replace(S,l.after(-T),new Ve(m,4-v,0));let I=-1;n.doc.nodesBetween(S,n.doc.content.size,(N,ke)=>{if(I>-1)return!1;N.isTextblock&&N.content.size===0&&(I=ke+1)}),I>-1&&n.setSelection(P.near(n.doc.resolve(I))),n.scrollIntoView()}return!0}const h=d.pos===l.end()?c.contentMatchAt(0).defaultType:null,f=y(y({},st(p,c.type.name,c.attrs)),t),g=y(y({},st(p,l.node().type.name,l.node().attrs)),t);n.delete(l.pos,d.pos);const b=h?[{type:a,attrs:f},{type:h,attrs:g}]:[{type:a,attrs:f}];if(!tt(n.doc,l.pos,2))return!1;if(r){const{selection:m,storedMarks:v}=s,{splittableMarks:T}=o.extensionManager,x=v||m.$to.parentOffset&&m.$from.marks();if(n.split(l.pos,2,b).scrollIntoView(),!x||!r)return!0;const E=x.filter(S=>T.includes(S.type.name));n.ensureMarks(E)}return!0},gt=(e,t)=>{const n=Et(i=>i.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&St(e.doc,n.pos)&&e.join(n.pos),!0},yt=(e,t)=>{const n=Et(i=>i.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&St(e.doc,s)&&e.join(s),!0},qs=(e,t,n,s={})=>({editor:r,tr:o,state:i,dispatch:a,chain:l,commands:d,can:u})=>{const{extensions:c,splittableMarks:p}=r.extensionManager,h=O(e,i.schema),f=O(t,i.schema),{selection:g,storedMarks:b}=i,{$from:m,$to:v}=g,T=m.blockRange(v),x=b||g.$to.parentOffset&&g.$from.marks();if(!T)return!1;const E=Et(S=>Vt(S.type.name,c))(g);if(T.depth>=1&&E&&T.depth-E.depth<=1){if(E.node.type===h)return d.liftListItem(f);if(Vt(E.node.type.name,c)&&h.validContent(E.node.content)&&a)return l().command(()=>(o.setNodeMarkup(E.pos,h),!0)).command(()=>gt(o,h)).command(()=>yt(o,h)).run()}return!n||!x||!a?l().command(()=>u().wrapInList(h,s)?!0:d.clearNodes()).wrapInList(h,s).command(()=>gt(o,h)).command(()=>yt(o,h)).run():l().command(()=>{const S=u().wrapInList(h,s),I=x.filter(N=>p.includes(N.type.name));return o.ensureMarks(I),S?!0:d.clearNodes()}).wrapInList(h,s).command(()=>gt(o,h)).command(()=>yt(o,h)).run()},Us=(e,t={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:o=!1}=n,i=j(e,s.schema);return wt(s,i,t)?r.unsetMark(i,{extendEmptyMarkRange:o}):r.setMark(i,t)},Gs=(e,t,n={})=>({state:s,commands:r})=>{const o=O(e,s.schema),i=O(t,s.schema);return U(s,o,n)?r.setNode(i):r.setNode(o,n)},Js=(e,t={})=>({state:n,commands:s})=>{const r=O(e,n.schema);return U(n,r,t)?s.lift(r):s.wrapIn(r,t)},Xs=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let o;if(r.spec.isInputRules&&(o=r.getState(e))){if(t){const i=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},Ys=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:s,ranges:r}=n;return s||t&&r.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},Qs=(e,t={})=>({tr:n,state:s,dispatch:r})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:a}=n,l=j(e,s.schema),{$from:d,empty:u,ranges:c}=a;if(!r)return!0;if(u&&i){let{from:p,to:h}=a;const f=(o=d.marks().find(b=>b.type===l))===null||o===void 0?void 0:o.attrs,g=At(d,l,f);g&&(p=g.from,h=g.to),n.removeMark(p,h,l)}else c.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},Zs=(e,t={})=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=ht(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(o=O(e,s.schema)),a==="mark"&&(i=j(e,s.schema)),r&&n.selection.ranges.forEach(l=>{const d=l.$from.pos,u=l.$to.pos;s.doc.nodesBetween(d,u,(c,p)=>{o&&o===c.type&&n.setNodeMarkup(p,void 0,y(y({},c.attrs),t)),i&&c.marks.length&&c.marks.forEach(h=>{if(i===h.type){const f=Math.max(p,d),g=Math.min(p+c.nodeSize,u);n.addMark(f,g,i.create(y(y({},h.attrs),t)))}})})}),!0):!1},tr=(e,t={})=>({state:n,dispatch:s})=>{const r=O(e,n.schema);return qe(r,t)(n,s)},er=(e,t={})=>({state:n,dispatch:s})=>{const r=O(e,n.schema);return Ue(r,t)(n,s)};var nr=Object.freeze({__proto__:null,blur:Bn,clearContent:Dn,clearNodes:_n,command:jn,createParagraphNear:Fn,cut:zn,deleteCurrentNode:Wn,deleteNode:Kn,deleteRange:Vn,deleteSelection:qn,enter:Un,exitCode:Gn,extendMarkRange:Xn,first:Yn,focus:Qn,forEach:Zn,insertContent:ts,insertContentAt:ss,joinBackward:is,joinDown:os,joinForward:as,joinItemBackward:ls,joinItemForward:ds,joinTextblockBackward:cs,joinTextblockForward:us,joinUp:rs,keyboardShortcut:hs,lift:fs,liftEmptyBlock:ms,liftListItem:gs,newlineInCode:ys,resetAttributes:bs,scrollIntoView:ks,selectAll:vs,selectNodeBackward:Ms,selectNodeForward:ws,selectParentNode:Ts,selectTextblockEnd:Ss,selectTextblockStart:Cs,setContent:As,setMark:Ds,setMeta:_s,setNode:js,setNodeSelection:Fs,setTextSelection:zs,sinkListItem:Ws,splitBlock:Ks,splitListItem:Vs,toggleList:qs,toggleMark:Us,toggleNode:Gs,toggleWrap:Js,undoInputRule:Xs,unsetAllMarks:Ys,unsetMark:Qs,updateAttributes:Zs,wrapIn:tr,wrapInList:er});const sr=L.create({name:"commands",addCommands(){return y({},nr)}}),rr=L.create({name:"editable",addProseMirrorPlugins(){return[new $({key:new R("editable"),props:{editable:()=>this.editor.options.editable}})]}}),or=L.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new $({key:new R("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const s=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{e.isFocused=!1;const s=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}}),ir=L.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:d}=a,{empty:u,$anchor:c}=l,{pos:p,parent:h}=c,f=c.parent.isTextblock&&p>0?a.doc.resolve(p-1):c,g=f.parent.type.spec.isolating,b=c.pos-c.parentOffset,m=g&&f.parent.childCount===1?b===c.pos:z.atStart(d).from===p;return!u||!h.type.isTextblock||h.textContent.length||!m||m&&c.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r=y({},s),o=C(y({},s),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return pt()||ue()?o:r},addProseMirrorPlugins(){return[new $({key:new R("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(f=>f.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:r,from:o,to:i}=t.selection,a=z.atStart(t.doc).from,l=z.atEnd(t.doc).to;if(r||!(o===a&&i===l)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const c=n.tr,p=at({state:n,transaction:c}),{commands:h}=new lt({editor:this.editor,state:p});if(h.clearNodes(),!!c.steps.length)return c}})]}}),ar=L.create({name:"tabindex",addProseMirrorPlugins(){return[new $({key:new R("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class F{get name(){return this.node.type.name}constructor(t,n,s=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=s,this.resolvedPos=t,this.editor=n,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,s=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,s=this.to-1}this.editor.commands.insertContentAt({from:n,to:s},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new F(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new F(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new F(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,s)=>{const r=n.isBlock&&!n.isTextblock,o=this.pos+s+1,i=this.resolvedPos.doc.resolve(o);if(!r&&i.depth<=this.depth)return;const a=new F(i,this.editor,r,r?n:null);r&&(a.actualDepth=this.depth+1),t.push(new F(i,this.editor,r,r?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let s=null,r=this.parent;for(;r&&!s;){if(r.node.type.name===t)if(Object.keys(n).length>0){const o=r.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==n[l])break}}else s=r;r=r.parent}return s}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},s=!1){let r=[];if(!this.children||this.children.length===0)return r;const o=Object.keys(n);return this.children.forEach(i=>{s&&r.length>0||(i.node.type.name===t&&o.every(l=>n[l]===i.node.attrs[l])&&r.push(i),!(s&&r.length>0)&&(r=r.concat(i.querySelectorAll(t,n,s))))}),r}setAttribute(t){const n=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,t).setTextSelection(n.from).run()}}const lr=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function dr(e,t,n){const s=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(s!==null)return s;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}let cr=class extends Mn{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n}},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=dr(lr,this.options.injectNonce))}setOptions(t={}){this.options=y(y({},this.options),t),!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const s=ie(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:s});this.view.updateState(r)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,s=this.state.reconfigure({plugins:this.state.plugins.filter(r=>!r.key.startsWith(n))});this.view.updateState(s)}createExtensionManager(){var t,n;const r=[...this.options.enableCoreExtensions?[rr,Nn.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),sr,or,ir,ar]:[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new K(r,this)}createCommandManager(){this.commandManager=new lt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let t;try{t=Mt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),t=Mt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=de(t,this.options.autofocus);this.view=new Xe(this.options.element,C(y({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:Ye.create({doc:t,selection:n||void 0})}));const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(t),s=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),o=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return he(this.state,t)}isActive(t,n){const s=typeof t=="string"?t:null,r=typeof t=="string"?n:t;return Ns(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Os(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:s={}}=t||{};return Hs(this.state.doc,{blockSeparator:n,textSerializers:y(y({},le(this.schema)),s)})}get isEmpty(){return Ot(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelector(t,n))||null}$nodes(t,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new F(n,this)}get $doc(){return this.$pos(0)}};function W(e){return new ct({find:e.find,handler:({state:t,range:n,match:s})=>{const r=M(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:o}=t,i=s[s.length-1],a=s[0];if(i){const l=a.search(/\S/),d=n.from+a.indexOf(i),u=d+i.length;if(Lt(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>d).length)return null;u<n.to&&o.delete(u,n.to),d>n.from&&o.delete(n.from+l,d);const p=n.from+l+i.length;o.addMark(n.from+l,p,e.type.create(r||{})),o.removeStoredMark(e.type)}}})}function ge(e){return new ct({find:e.find,handler:({state:t,range:n,match:s})=>{const r=M(e.getAttributes,void 0,s)||{},{tr:o}=t,i=n.from;let a=n.to;const l=e.type.create(r);if(s[1]){const d=s[0].lastIndexOf(s[1]);let u=i+d;u>a?u=a:a=u+s[1].length;const c=s[0][s[0].length-1];o.insertText(c,i+s[0].length-1),o.replaceWith(u,a,l)}else if(s[0]){const d=e.type.isInline?i:i-1;o.insert(d,e.type.create(r)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function Tt(e){return new ct({find:e.find,handler:({state:t,range:n,match:s})=>{const r=t.doc.resolve(n.from),o=M(e.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function q(e){return new ct({find:e.find,handler:({state:t,range:n,match:s,chain:r})=>{const o=M(e.getAttributes,void 0,s)||{},i=t.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),d=l&&Te(l,e.type,o);if(!d)return null;if(i.wrap(l,d),e.keepMarks&&e.editor){const{selection:c,storedMarks:p}=t,{splittableMarks:h}=e.editor.extensionManager,f=p||c.$to.parentOffset&&c.$from.marks();if(f){const g=f.filter(b=>h.includes(b.type.name));i.ensureMarks(g)}}if(e.keepAttributes){const c=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(c,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&St(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(s,u))&&i.join(n.from-1)}})}class H{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=y(y({},this.config),t),this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(k(this,"addOptions",{name:this.name}))),this.storage=M(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new H(t)}configure(t={}){const n=this.extend(C(y({},this.config),{addOptions:()=>ut(this.options,t)}));return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new H(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(k(n,"addOptions",{name:n.name})),n.storage=M(k(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:s}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const i=r.marks();if(!!!i.find(d=>(d==null?void 0:d.type.name)===n.name))return!1;const l=i.find(d=>(d==null?void 0:d.type.name)===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),t.view.dispatch(s),!0}return!1}}class A{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=y(y({},this.config),t),this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(k(this,"addOptions",{name:this.name}))),this.storage=M(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new A(t)}configure(t={}){const n=this.extend(C(y({},this.config),{addOptions:()=>ut(this.options,t)}));return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new A(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(k(n,"addOptions",{name:n.name})),n.storage=M(k(n,"addStorage",{name:n.name,options:n.options})),n}}function ur(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}class pr{constructor(t,n,s){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options=y({stopEvent:null,ignoreMutation:null},s),this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,s,r,o,i,a,l;const{view:d}=this.editor,u=t.target,c=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(u)||!c)return;let p=0,h=0;if(this.dom!==c){const b=this.dom.getBoundingClientRect(),m=c.getBoundingClientRect(),v=(r=t.offsetX)!==null&&r!==void 0?r:(o=t.nativeEvent)===null||o===void 0?void 0:o.offsetX,T=(i=t.offsetY)!==null&&i!==void 0?i:(a=t.nativeEvent)===null||a===void 0?void 0:a.offsetY;p=m.x-b.x+v,h=m.y-b.y+T}(l=t.dataTransfer)===null||l===void 0||l.setDragImage(this.dom,p,h);const f=V.create(d.state.doc,this.getPos()),g=d.state.tr.setSelection(f);d.dispatch(g)}stopEvent(t){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const s=t.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const o=t.type.startsWith("drag"),i=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!i&&!o)return!0;const{isEditable:l}=this.editor,{isDragging:d}=this,u=!!this.node.type.spec.draggable,c=V.isSelectable(this.node),p=t.type==="copy",h=t.type==="paste",f=t.type==="cut",g=t.type==="mousedown";if(!u&&c&&o&&t.preventDefault(),u&&o&&!d)return t.preventDefault(),!1;if(u&&l&&!d&&g){const b=s.closest("[data-drag-handle]");b&&(this.dom===b||this.dom.contains(b))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(d||i||p||h||f||g&&c)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&(pt()||ur())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return n.setNodeMarkup(s,void 0,y(y({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos(),n=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:n})}}function _(e){return new Ln({find:e.find,handler:({state:t,range:n,match:s,pasteEvent:r})=>{const o=M(e.getAttributes,void 0,s,r);if(o===!1||o===null)return null;const{tr:i}=t,a=s[s.length-1],l=s[0];let d=n.to;if(a){const u=l.search(/\S/),c=n.from+l.indexOf(a),p=c+a.length;if(Lt(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(b=>b===e.type&&b!==f.mark.type)).filter(f=>f.to>c).length)return null;p<n.to&&i.delete(p,n.to),c>n.from&&i.delete(n.from+u,c),d=n.from+u+a.length,i.addMark(n.from+u,d,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}class hr{constructor({editor:t,element:n,view:s,tippyOptions:r={},updateDelay:o=250,shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:d,to:u})=>{const{doc:c,selection:p}=l,{empty:h}=p,f=!c.textBetween(d,u).length&&xt(l.selection),g=this.element.contains(document.activeElement);return!(!(a.hasFocus()||g)||h||f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const d=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!d&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,d,u,l)},this.updateDelay))},this.updateHandler=(a,l,d,u)=>{var c,p,h;const{state:f,composing:g}=a,{selection:b}=f;if(g||!l&&!d)return;this.createTooltip();const{ranges:v}=b,T=Math.min(...v.map(S=>S.$from.pos)),x=Math.max(...v.map(S=>S.$to.pos));if(!((c=this.shouldShow)===null||c===void 0?void 0:c.call(this,{editor:this.editor,view:a,state:f,oldState:u,from:T,to:x}))){this.hide();return}(p=this.tippy)===null||p===void 0||p.setProps({getReferenceClientRect:((h=this.tippyOptions)===null||h===void 0?void 0:h.getReferenceClientRect)||(()=>{if(fe(f.selection)){let S=a.nodeDOM(T);const I=S.dataset.nodeViewWrapper?S:S.querySelector("[data-node-view-wrapper]");if(I&&(S=I.firstChild),S)return S.getBoundingClientRect()}return me(a,T,x)})}),this.show()},this.editor=t,this.element=n,this.view=s,this.updateDelay=o,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=ne(t,y({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:s}=t,r=s.selection.from!==s.selection.to;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(t,n);return}const o=!(n!=null&&n.selection.eq(t.state.selection)),i=!(n!=null&&n.doc.eq(t.state.doc));this.updateHandler(t,o,i,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const ye=e=>new $({key:typeof e.pluginKey=="string"?new R(e.pluginKey):e.pluginKey,view:t=>new hr(y({view:t},e))});L.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[ye({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class fr{constructor({editor:t,element:n,view:s,tippyOptions:r={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:i,state:a})=>{const{selection:l}=a,{$anchor:d,empty:u}=l,c=d.depth===1,p=d.parent.isTextblock&&!d.parent.type.spec.code&&!d.parent.textContent;return!(!i.hasFocus()||!u||!c||!p||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:i})=>{var a;if(this.preventHide){this.preventHide=!1;return}i!=null&&i.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(i.relatedTarget))||this.hide()},this.tippyBlurHandler=i=>{this.blurHandler({event:i})},this.editor=t,this.element=n,this.view=s,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=ne(t,y({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){var s,r,o;const{state:i}=t,{doc:a,selection:l}=i,{from:d,to:u}=l;if(n&&n.doc.eq(a)&&n.selection.eq(l))return;if(this.createTooltip(),!((s=this.shouldShow)===null||s===void 0?void 0:s.call(this,{editor:this.editor,view:t,state:i,oldState:n}))){this.hide();return}(r=this.tippy)===null||r===void 0||r.setProps({getReferenceClientRect:((o=this.tippyOptions)===null||o===void 0?void 0:o.getReferenceClientRect)||(()=>me(t,d,u))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const be=e=>new $({key:typeof e.pluginKey=="string"?new R(e.pluginKey):e.pluginKey,view:t=>new fr(y({view:t},e))});L.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[be({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const bo={name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},watch:{editor:{immediate:!0,handler(e){e&&this.$nextTick(()=>{e.registerPlugin(ye({updateDelay:this.updateDelay,editor:e,element:this.$el,pluginKey:this.pluginKey,shouldShow:this.shouldShow,tippyOptions:this.tippyOptions}))})}}},render(e){return e("div",{style:{visibility:"hidden"}},this.$slots.default)},beforeDestroy(){this.editor.unregisterPlugin(this.pluginKey)}};class ko extends cr{constructor(){super(...arguments),this.contentComponent=null}}const vo={name:"EditorContent",props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler(e){e&&e.options.element&&this.$nextTick(()=>{const t=this.$el;!t||!e.options.element.firstChild||(t.append(...e.options.element.childNodes),e.contentComponent=this,e.setOptions({element:t}),e.createNodeViews())})}}},render(e){return e("div")},beforeDestroy(){const{editor:e}=this;if(!e||(e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}},Mo={name:"FloatingMenu",props:{pluginKey:{type:[String,Object],default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},watch:{editor:{immediate:!0,handler(e){e&&this.$nextTick(()=>{e.registerPlugin(be({pluginKey:this.pluginKey,editor:e,element:this.$el,tippyOptions:this.tippyOptions,shouldShow:this.shouldShow}))})}}},render(e){return e("div",{style:{visibility:"hidden"}},this.$slots.default)},beforeDestroy(){this.editor.unregisterPlugin(this.pluginKey)}},wo={props:{as:{type:String,default:"div"}},render(e){return e(this.as,{style:{whiteSpace:"pre-wrap"},attrs:{"data-node-view-content":""}})}},To={props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(e){return e(this.as,{class:this.decorationClasses.value,style:{whiteSpace:"normal"},attrs:{"data-node-view-wrapper":""},on:{dragstart:this.onDragStart}},this.$slots.default)}};class mr{constructor(t,n){const s=typeof t=="function"?t:rt.extend(t);this.ref=new s(n).$mount()}get element(){return this.ref.$el}updateProps(t={}){var n,s,r;if(!this.ref.$props)return;const o=(r=(s=(n=this.ref.$props.editor)===null||n===void 0?void 0:n.contentComponent)===null||s===void 0?void 0:s.$options._base)!==null&&r!==void 0?r:rt,i=o.config.silent;o.config.silent=!0,Object.entries(t).forEach(([a,l])=>{this.ref.$props[a]=l}),o.config.silent=i}destroy(){this.ref.$destroy()}}const So={editor:D.objectProp().required,node:D.objectProp().required,decorations:D.objectProp().required,selected:D.booleanProp().required,extension:D.objectProp().required,getPos:D.functionProp().required,updateAttributes:D.functionProp().required,deleteNode:D.functionProp().required};class gr extends pr{mount(){var t,n;const s={editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(a={})=>this.updateAttributes(a),deleteNode:()=>this.deleteNode()},r=this.onDragStart.bind(this);this.decorationClasses=rt.observable({value:this.getDecorationClasses()});const i=((n=(t=this.editor.contentComponent)===null||t===void 0?void 0:t.$options._base)!==null&&n!==void 0?n:rt).extend(this.component).extend({props:Object.keys(s),provide:()=>({onDragStart:r,decorationClasses:this.decorationClasses})});this.renderer=new mr(i,{parent:this.editor.contentComponent,propsData:s})}get dom(){if(!this.renderer.element.hasAttribute("data-node-view-wrapper"))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.dom.querySelector("[data-node-view-content]")||this.dom}update(t,n){const s=r=>{this.decorationClasses.value=this.getDecorationClasses(),this.renderer.updateProps(r)};if(typeof this.options.update=="function"){const r=this.node,o=this.decorations;return this.node=t,this.decorations=n,this.options.update({oldNode:r,oldDecorations:o,newNode:t,newDecorations:n,updateProps:()=>s({node:t,decorations:n})})}return t.type!==this.node.type?!1:(t===this.node&&this.decorations===n||(this.node=t,this.decorations=n,s({node:t,decorations:n})),!0)}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}getDecorationClasses(){return this.decorations.map(t=>t.type.attrs.class).flat().join(" ")}destroy(){this.renderer.destroy()}}function Co(e,t){return n=>n.editor.contentComponent?new gr(e,n,t):{}}function yr(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function br(e){return new $({key:new R("autolink"),appendTransaction:(t,n,s)=>{const r=t.some(d=>d.docChanged)&&!n.doc.eq(s.doc),o=t.some(d=>d.getMeta("preventAutolink"));if(!r||o)return;const{tr:i}=s,a=xs(n.doc,[...t]);if(Rs(a).forEach(({newRange:d})=>{const u=Ls(s.doc,d,h=>h.isTextblock);let c,p;if(u.length>1?(c=u[0],p=s.doc.textBetween(c.pos,c.pos+c.node.nodeSize,void 0," ")):u.length&&s.doc.textBetween(d.from,d.to," "," ").endsWith(" ")&&(c=u[0],p=s.doc.textBetween(c.pos,d.to,void 0," ")),c&&p){const h=p.split(" ").filter(m=>m!=="");if(h.length<=0)return!1;const f=h[h.length-1],g=c.pos+p.lastIndexOf(f);if(!f)return!1;const b=tn(f).map(m=>m.toObject(e.defaultProtocol));if(!yr(b))return!1;b.filter(m=>m.isLink).map(m=>C(y({},m),{from:g+m.start+1,to:g+m.end+1})).filter(m=>s.schema.marks.code?!s.doc.rangeHasMark(m.from,m.to,s.schema.marks.code):!0).filter(m=>e.validate(m.value)).forEach(m=>{Lt(m.from,m.to,s.doc).some(v=>v.mark.type===e.type)||i.addMark(m.from,m.to,e.type.create({href:m.href}))})}}),!!i.steps.length)return i}})}function kr(e){return new $({key:new R("handleClickLink"),props:{handleClick:(t,n,s)=>{var r,o;if(s.button!==0||!t.editable)return!1;let i=s.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const l=he(t.state,e.type.name),d=s.target,u=(r=d==null?void 0:d.href)!==null&&r!==void 0?r:l.href,c=(o=d==null?void 0:d.target)!==null&&o!==void 0?o:l.target;return d&&u?(window.open(u,c),!0):!1}}})}function vr(e){return new $({key:new R("handlePasteLink"),props:{handlePaste:(t,n,s)=>{const{state:r}=t,{selection:o}=r,{empty:i}=o;if(i)return!1;let a="";s.content.forEach(d=>{a+=d.textContent});const l=se(a,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===a);return!a||!l?!1:(e.editor.commands.setMark(e.type,{href:l.href}),!0)}}})}const Mr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function Ut(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(s=>{const r=typeof s=="string"?s:s.scheme;r&&n.push(r)}),!e||e.replace(Mr,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))`,"i"))}const Ao=H.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.protocols.forEach(e=>{if(typeof e=="string"){Nt(e);return}Nt(e.scheme,e.optionalSlashes)})},onDestroy(){en()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!Ut(t,this.options.protocols)?!1:null}}]},renderHTML({HTMLAttributes:e}){return Ut(e.href,this.options.protocols)?["a",w(this.options.HTMLAttributes,e),0]:["a",w(this.options.HTMLAttributes,C(y({},e),{href:""})),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[_({find:e=>{const t=[];if(e){const{validate:n}=this.options,s=se(e).filter(r=>r.isLink&&n(r.value));s.length&&s.forEach(r=>t.push({text:r.value,data:{href:r.href},index:r.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(br({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:this.options.validate})),this.options.openOnClick===!0&&e.push(kr({type:this.type})),this.options.linkOnPaste&&e.push(vr({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),wr=/^```([a-z]+)?[\s\n]$/,Tr=/^~~~([a-z]+)?[\s\n]$/,Sr=A.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",w(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const o=s.parentOffset===s.parent.nodeSize-2,i=s.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:s}=t,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?e.commands.command(({tr:d})=>(d.setSelection(z.near(s.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[Tt({find:wr,type:this.type,getAttributes:e=>({language:e[1]})}),Tt({find:Tr,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new $({key:new R("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),s=t.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,o=r==null?void 0:r.mode;if(!n||!o)return!1;const{tr:i,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(P.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),xo=H.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),Eo=H.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),Lo=H.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",w(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=G(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Oo=L.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>{var t;return(t=e.style.fontFamily)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.fontFamily?{style:`font-family: ${e.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:e=>({chain:t})=>t().setMark("textStyle",{fontFamily:e}).run(),unsetFontFamily:()=>({chain:e})=>e().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),Ho=L.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign||this.options.defaultAlignment;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Cr=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",w(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ar=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",w(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Gt=H.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",w(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=G(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Jt=/^\s*([-+*])\s$/,xr=A.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",w(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ar.name,this.editor.getAttributes(Gt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=q({find:Jt,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=q({find:Jt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Gt.name),editor:this.editor})),[e]}}),Er=A.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",w(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Xt=H.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",w(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=G(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Yt=/^(\d+)\.\s$/,Lr=A.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const s=e,{start:t}=s,n=It(s,["start"]);return t===1?["ol",w(this.options.HTMLAttributes,n),0]:["ol",w(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Er.name,this.editor.getAttributes(Xt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=q({find:Yt,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=q({find:Yt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>y({start:+t[1]},this.editor.getAttributes(Xt.name)),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),Po=H.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),$o=L.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Or=/^\s*>\s$/,Hr=A.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[q({find:Or,type:this.type})]}}),Pr=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,$r=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,Io=H.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[W({find:Pr,type:this.type})]},addPasteRules(){return[_({find:$r,type:this.type})]}}),Ro=L.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new $({key:new R("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=t,r=[];if(!n)return null;const o=this.editor.isEmpty;return e.descendants((i,a)=>{const l=s>=a&&s<=a+i.nodeSize,d=!i.isLeaf&&Ot(i);if((l||!this.options.showOnlyCurrent)&&d){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const c=bt.node(a,a+i.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:l}):this.options.placeholder});r.push(c)}return this.options.includeChildren}),nt.create(e,r)}}})]}}),Ir=A.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",w(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:s})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:o}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=s.extensionManager,l=o||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:d,dispatch:u})=>{if(u&&l&&i){const c=l.filter(p=>a.includes(p.type.name));d.ensureMarks(c)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});function Qt(e,t,n,s,r,o){let i=0,a=!0,l=t.firstChild;const d=e.firstChild;for(let u=0,c=0;u<d.childCount;u+=1){const{colspan:p,colwidth:h}=d.child(u).attrs;for(let f=0;f<p;f+=1,c+=1){const g=r===c?o:h&&h[f],b=g?`${g}px`:"";i+=g||s,g||(a=!1),l?(l.style.width!==b&&(l.style.width=b),l=l.nextSibling):t.appendChild(document.createElement("col")).style.width=b}}for(;l;){const u=l.nextSibling;l.parentNode.removeChild(l),l=u}a?(n.style.width=`${i}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${i}px`)}class Rr{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Qt(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,Qt(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function Nr(e,t,n,s){let r=0,o=!0;const i=[],a=e.firstChild;if(!a)return{};for(let c=0,p=0;c<a.childCount;c+=1){const{colspan:h,colwidth:f}=a.child(c).attrs;for(let g=0;g<h;g+=1,p+=1){const b=n===p?s:f&&f[g],m=b?`${b}px`:"";r+=b||t,b||(o=!1),i.push(["col",m?{style:`width: ${m}`}:{}])}}const l=o?`${r}px`:"",d=o?"":`${r}px`;return{colgroup:["colgroup",{},...i],tableWidth:l,tableMinWidth:d}}function Zt(e,t){return t?e.createChecked(null,t):e.createAndFill()}function Br(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const s=e.nodes[n];s.spec.tableRole&&(t[s.spec.tableRole]=s)}),e.cached.tableNodeTypes=t,t}function Dr(e,t,n,s,r){const o=Br(e),i=[],a=[];for(let d=0;d<n;d+=1){const u=Zt(o.cell,r);if(u&&a.push(u),s){const c=Zt(o.header_cell,r);c&&i.push(c)}}const l=[];for(let d=0;d<t;d+=1)l.push(o.row.createChecked(null,s&&d===0?i:a));return o.table.createChecked(null,l)}function _r(e){return e instanceof re}const Z=({editor:e})=>{const{selection:t}=e.state;if(!_r(t))return!1;let n=0;const s=pe(t.ranges[0].$from,o=>o.type.name==="table");return s==null||s.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},No=A.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Rr,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:s,tableMinWidth:r}=Nr(e,this.options.cellMinWidth);return["table",w(this.options.HTMLAttributes,t,{style:s?`width: ${s}`:`min-width: ${r}`}),n,["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:o})=>{const i=Dr(o.schema,e,t,n);if(r){const a=s.selection.from+1;s.replaceSelectionWith(i).scrollIntoView().setSelection(P.near(s.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>nn(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>sn(e,t),deleteColumn:()=>({state:e,dispatch:t})=>rn(e,t),addRowBefore:()=>({state:e,dispatch:t})=>on(e,t),addRowAfter:()=>({state:e,dispatch:t})=>an(e,t),deleteRow:()=>({state:e,dispatch:t})=>ln(e,t),deleteTable:()=>({state:e,dispatch:t})=>dn(e,t),mergeCells:()=>({state:e,dispatch:t})=>Bt(e,t),splitCell:()=>({state:e,dispatch:t})=>Dt(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>_t("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>_t("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>cn(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>Bt(e,t)?!0:Dt(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:s})=>un(e,t)(n,s),goToNextCell:()=>({state:e,dispatch:t})=>jt(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>jt(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&pn(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const s=re.create(t.doc,e.anchorCell,e.headCell);t.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Z,"Mod-Backspace":Z,Delete:Z,"Mod-Delete":Z}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[hn({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],fn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:M(k(e,"tableRole",t))}}}),Bo=A.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",w(this.options.HTMLAttributes,e),0]}}),Do=A.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",w(this.options.HTMLAttributes,e),0]}}),_o=A.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",w(this.options.HTMLAttributes,e),0]}}),jr=L.create({name:"gapCursor",addProseMirrorPlugins(){return[mn()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=M(k(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),Fr=/^\s*(\[([( |x])?\])\s$/,jo=A.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",w(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?C(y({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:s})=>{const r=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return o.contentEditable="false",a.type="checkbox",a.addEventListener("change",d=>{if(!s.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:u}=d.target;s.isEditable&&typeof n=="function"&&s.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:c})=>{const p=n(),h=c.doc.nodeAt(p);return c.setNodeMarkup(p,void 0,C(y({},h==null?void 0:h.attrs),{checked:u})),!0}).run(),!s.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,u])=>{r.setAttribute(d,u)}),r.dataset.checked=e.attrs.checked,e.attrs.checked&&a.setAttribute("checked","checked"),o.append(a,i),r.append(o,l),Object.entries(t).forEach(([d,u])=>{r.setAttribute(d,u)}),{dom:r,contentDOM:l,update:d=>d.type!==this.type?!1:(r.dataset.checked=d.attrs.checked,d.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[q({find:Fr,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),Fo=A.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",w(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),zr=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Wr=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Kr=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Vr=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,qr=H.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[W({find:zr,type:this.type}),W({find:Kr,type:this.type})]},addPasteRules(){return[_({find:Wr,type:this.type}),_({find:Vr,type:this.type})]}}),Ur=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,Gr=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,Jr=H.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[W({find:Ur,type:this.type})]},addPasteRules(){return[_({find:Gr,type:this.type})]}}),Xr=A.create({name:"doc",topNode:!0,content:"block+"}),Yr=L.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[gn(this.options)]}}),Qr=A.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,w(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>C(y({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Tt({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Zr=L.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>yn(e,t),redo:()=>({state:e,dispatch:t})=>bn(e,t)}},addProseMirrorPlugins(){return[kn(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),to=A.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",w(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:s,$to:r}=n,o=e();return s.parentOffset===0?o.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):fe(n)?o.insertContentAt(r.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:a})=>{var l;if(a){const{$to:d}=i.selection,u=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?i.setSelection(P.create(i.doc,d.pos+1)):d.nodeAfter.isBlock?i.setSelection(V.create(i.doc,d.pos)):i.setSelection(P.create(i.doc,d.pos));else{const c=(l=d.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();c&&(i.insert(u,c),i.setSelection(P.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[ge({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),eo=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,no=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,so=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,ro=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,oo=H.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[W({find:eo,type:this.type}),W({find:so,type:this.type})]},addPasteRules(){return[_({find:no,type:this.type}),_({find:ro,type:this.type})]}}),io=A.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ao=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,lo=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,co=H.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",w(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[W({find:ao,type:this.type})]},addPasteRules(){return[_({find:lo,type:this.type})]}}),uo=A.create({name:"text",group:"inline"}),zo=L.create({name:"starterKit",addExtensions(){var e,t,n,s,r,o,i,a,l,d,u,c,p,h,f,g,b,m;const v=[];return this.options.bold!==!1&&v.push(qr.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.blockquote!==!1&&v.push(Hr.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bulletList!==!1&&v.push(xr.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&v.push(Jr.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&v.push(Sr.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&v.push(Xr.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&v.push(Yr.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&v.push(jr.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&v.push(Ir.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&v.push(Qr.configure((d=this.options)===null||d===void 0?void 0:d.heading)),this.options.history!==!1&&v.push(Zr.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&v.push(to.configure((c=this.options)===null||c===void 0?void 0:c.horizontalRule)),this.options.italic!==!1&&v.push(oo.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&v.push(Cr.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&v.push(Lr.configure((f=this.options)===null||f===void 0?void 0:f.orderedList)),this.options.paragraph!==!1&&v.push(io.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&v.push(co.configure((b=this.options)===null||b===void 0?void 0:b.strike)),this.options.text!==!1&&v.push(uo.configure((m=this.options)===null||m===void 0?void 0:m.text)),v}}),po=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Wo=A.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",w(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[ge({find:po,type:this.type,getAttributes:e=>{const[,,t,n,s]=e;return{src:n,alt:t,title:s}}})]}}),ho=e=>{const{regex:t,katexOptions:n={},editor:s,shouldRender:r}=e;return new $({key:new R("mathematics"),state:{init:()=>nt.empty,apply(o,i,a,l){const{selection:d}=l,u=[];return l.doc.descendants((c,p)=>{const h=r(l,p,c);if(c.isText&&c.text&&h){let f;for(;f=t.exec(c.text);){const g=p+f.index,b=g+f[0].length,m=f.slice(1).find(Boolean);if(m){const v=d.$from.pos-d.$to.pos,T=d.$anchor.pos>=g&&d.$anchor.pos<=b,x=d.$from.pos>=g&&d.$to.pos<=b,E=v===0&&T||x;E&&s.isEditable||u.push(bt.widget(g,()=>{const S=document.createElement("span");S.classList.add("Tiptap-mathematics-render"),s.isEditable&&S.classList.add("Tiptap-mathematics-render--editable");try{vn.render(m,S,n)}catch(I){S.innerHTML=m}return S})),u.push(bt.inline(g,b,{class:E&&s.isEditable?"Tiptap-mathematics-editor":"Tiptap-mathematics-editor Tiptap-mathematics-editor--hidden",style:E&&s.isEditable?void 0:"display: inline-block; height: 0; opacity: 0; overflow: hidden; position: absolute; width: 0;"}))}}}}),u.length>0?nt.create(l.doc,u):nt.empty}},props:{decorations(o){return this.getState(o)}}})},fo=(e,t)=>e.doc.resolve(t).parent.type.name!=="codeBlock",Ko=L.create({name:"Mathematics",addOptions:()=>({regex:/\$([^\$]*)\$/gi,katexOptions:void 0,shouldRender:fo}),addProseMirrorPlugins(){return[ho(C(y({},this.options),{editor:this.editor}))]}});export{Io as A,bo as B,Sr as C,Xr as D,L as E,Mo as F,xr as G,to as H,Wo as I,jr as J,No as K,Ao as L,_o as M,To as N,Lr as O,io as P,Do as Q,Bo as R,zo as S,Lo as T,Po as U,Co as V,qr as W,xt as X,A as a,Cr as b,vo as c,ko as d,wo as e,Jr as f,Yr as g,Fo as h,jo as i,Eo as j,xo as k,oo as l,w as m,So as n,Oo as o,Ko as p,co as q,Ir as r,Qr as s,Zr as t,Hr as u,uo as v,q as w,Ho as x,$o as y,Ro as z};
//# sourceMappingURL=tiptap.5ae55db7.js.map
